name: End-to-End Tests (Selenium/Docker)

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  e2e_tests:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ“¥ Checkout du code
      uses: actions/checkout@v4

    # --- 1. CONFIGURATION DOCKER (CONSTRUCTION DE L'IMAGE) ---
    - name: ğŸ› ï¸ Construire l'image Docker
      run: docker build -t my-e2e-image .

    # --- 2. EXÃ‰CUTION DES TESTS (COMMANDE CORRIGÃ‰E) ---
    - name: ğŸš€ Lancer les tests Pytest avec Ulimit Fix
      run: |
        # AJOUT CRITIQUE : --ulimit nofile=32768
        docker run \
          --rm \
          --ulimit nofile=32768 \
          my-e2e-image \
          pytest
      # Le reste du workflow (reports) reste inchangÃ©

    # ... autres Ã©tapes (upload-artifact, etc.)